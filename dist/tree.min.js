/*!
 * treejs
 * @version 1.2.0
 * @see https://github.com/daweilv/treejs
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Tree=t():e.Tree=t()}(window,function(){return function(e){var t={};function s(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,s),i.l=!0,i.exports}return s.m=e,s.c=t,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},s.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n,i=(n=s(1))&&n.__esModule?n:{default:n};function o(e,t){var s=this;this.treeNodes=[],this.nodesById={},this.leafNodesById={},this.liElementsById={},this._willUpdateNodesById={},this.container=e,this.options=Object.assign({selectMode:"checkbox",values:[],disables:[],beforeLoad:null,loaded:null,url:null,method:"GET"},t),Object.defineProperties(this,{values:{get:function(){return this.getValues()},set:function(e){return this.setValues(a(e))}},disables:{get:function(){return this.getDisables()},set:function(e){return this.setDisables(a(e))}},selectedNodes:{get:function(){var e=[],t=this.nodesById;for(var s in t)if(t.hasOwnProperty(s)&&(1===t[s].status||2===t[s].status)){var n=Object.assign({},t[s]);delete n.parent,e.push(n)}return e}},disabledNodes:{get:function(){var e=[],t=this.nodesById;for(var s in t)if(t.hasOwnProperty(s)&&t[s].disabled){var n=Object.assign({},t[s]);delete n.parent,e.push(n)}return e}}}),this.options.url?this.load(function(e){s.init(e)}):this.init(this.options.data)}function a(e){var t={},s=[];return e.forEach(function(e){t[e]||(t[e]=!0,s.push(e))}),s}s(2),o.prototype.init=function(e){console.time("init");var t=o.parseTreeData(e),s=t.treeNodes,n=t.nodesById,i=t.leafNodesById,a=t.defaultValues,d=t.defaultDisables;this.treeNodes=s,this.nodesById=n,this.leafNodesById=i,this.render(this.treeNodes);var r=this.options,l=r.values,c=r.disables,u=r.loaded;l&&l.length&&(a=l),a.length&&this.setValues(a),c&&c.length&&(d=c),d.length&&this.setDisables(d),u&&u.call(this),console.timeEnd("init")},o.prototype.load=function(e){console.time("load");var t=this.options,s=t.url,n=t.method,o=t.beforeLoad;(0,i.default)({url:s,method:n,success:function(t){var s=t;console.time("load"),o&&(s=o(t)),e(s)}})},o.prototype.render=function(e){var t=o.createRootEle();t.appendChild(this.buildTree(e)),this.bindEvent(t);var s=document.querySelector(this.container);!function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}(s),s.appendChild(t)},o.prototype.buildTree=function(e){var t=this,s=o.createUlEle();return e&&e.length&&e.forEach(function(e){var n=o.createLiEle(e);t.liElementsById[e.id]=n;var i=null;e.children&&e.children.length&&(i=t.buildTree(e.children)),i&&n.appendChild(i),s.appendChild(n)}),s},o.prototype.bindEvent=function(e){var t=this;e.addEventListener("click",function(e){var s=e.target;"SPAN"===s.nodeName&&s.classList.contains("treejs-checkbox")?t.onItemClick(s.parentNode.nodeId):"LI"===s.nodeName&&s.classList.contains("treejs-node")?t.onItemClick(s.nodeId):"SPAN"===s.nodeName&&s.classList.contains("treejs-switcher")&&t.onSwitcherClick(s)},!1)},o.prototype.onItemClick=function(e){console.time("onItemClick"),this.nodesById[e].disabled||(this.setValue(e),this.updateLiElements()),console.timeEnd("onItemClick")},o.prototype.setValue=function(e){var t=this.nodesById[e];if(t){var s=t.status,n=1===s||2===s?0:2;t.status=n,this.markWillUpdateNode(t),this.walkUp(t,"status"),this.walkDown(t,"status")}},o.prototype.getValues=function(){var e=[];for(var t in this.leafNodesById)this.leafNodesById.hasOwnProperty(t)&&(1!==this.leafNodesById[t].status&&2!==this.leafNodesById[t].status||e.push(t));return e},o.prototype.setValues=function(e){var t=this;this.emptyNodesCheckStatus(),e.forEach(function(e){t.setValue(e)}),this.updateLiElements()},o.prototype.setDisable=function(e){var t=this.nodesById[e];t&&(t.disabled||(t.disabled=!0,this.markWillUpdateNode(t),this.walkUp(t,"disabled"),this.walkDown(t,"disabled")))},o.prototype.getDisables=function(){var e=[];for(var t in this.leafNodesById)this.leafNodesById.hasOwnProperty(t)&&this.leafNodesById[t].disabled&&e.push(t);return e},o.prototype.setDisables=function(e){var t=this;this.emptyNodesDisable(),e.forEach(function(e){t.setDisable(e)}),this.updateLiElements()},o.prototype.emptyNodesCheckStatus=function(){var e=this._willUpdateNodesById=this.getSelectedNodesById();for(var t in e)e.hasOwnProperty(t)&&!e.disabled&&(e[t].status=0)},o.prototype.emptyNodesDisable=function(){var e=this._willUpdateNodesById=this.getDisabledNodesById();for(var t in e)e.hasOwnProperty(t)&&(e[t].disabled=!1)},o.prototype.getSelectedNodesById=function(){var e={},t=this.nodesById;for(var s in t)!t.hasOwnProperty(s)||1!==t[s].status&&2!==t[s].status||(e[s]=t[s]);return e},o.prototype.getDisabledNodesById=function(){var e={},t=this.nodesById;for(var s in t)t.hasOwnProperty(s)&&t[s].disabled&&(e[s]=t[s]);return e},o.prototype.updateLiElements=function(){var e=this._willUpdateNodesById;for(var t in e)e.hasOwnProperty(t)&&this.updateLiElement(e[t]);this._willUpdateNodesById={}},o.prototype.markWillUpdateNode=function(e){this._willUpdateNodesById[e.id]=e},o.prototype.onSwitcherClick=function(e){var t=e.parentNode,s=t.lastChild;if(t.classList.contains("treejs-node__close"))t.classList.remove("treejs-node__close"),s.style.height="auto";else{var n=getComputedStyle(s).height;s.style.height=n,setTimeout(function(){s.style.height="0px"}),t.classList.add("treejs-node__close")}},o.prototype.walkUp=function(e,t){var s=e.parent;if(s){if("status"===t){var n=null,i=0;if(s.children.forEach(function(e){isNaN(e.status)||(i+=e.status)}),n=i?i===2*s.children.length?2:1:0,s.status===n)return;s.status=n}else{var o=!0;if(s.children.forEach(function(e){o=o&&e.disabled}),s.disabled===o)return;s.disabled=o}this.markWillUpdateNode(s),this.walkUp(s,t)}},o.prototype.walkDown=function(e,t){var s=this;e.children&&e.children.length&&e.children.forEach(function(n){"status"===t&&n.disabled||(n[t]=e[t],s.markWillUpdateNode(n),s.walkDown(n,t))})},o.prototype.updateLiElement=function(e){var t=this.liElementsById[e.id].classList;switch(e.status){case 0:t.remove("treejs-node__halfchecked","treejs-node__checked");break;case 1:t.remove("treejs-node__checked"),t.add("treejs-node__halfchecked");break;case 2:t.remove("treejs-node__halfchecked"),t.add("treejs-node__checked")}switch(e.disabled){case!0:t.contains("treejs-node__disabled")||t.add("treejs-node__disabled");break;case!1:t.contains("treejs-node__disabled")&&t.remove("treejs-node__disabled")}},o.parseTreeData=function(e){var t,s=(t=e,JSON.parse(JSON.stringify(t))),n={},i={},o=[],a=[];return function e(t,s){t.forEach(function(t){n[t.id]=t,t.checked&&o.push(t.id),t.disabled&&a.push(t.id),s&&(t.parent=s),t.children&&t.children.length?e(t.children,t):i[t.id]=t})}(s),{treeNodes:s,nodesById:n,leafNodesById:i,defaultValues:o,defaultDisables:a}},o.createRootEle=function(){var e=document.createElement("div");return e.classList.add("treejs"),e},o.createUlEle=function(){var e=document.createElement("ul");return e.classList.add("treejs-nodes"),e},o.createLiEle=function(e){var t=document.createElement("li");if(t.classList.add("treejs-node"),e.children&&e.children.length){var s=document.createElement("span");s.classList.add("treejs-switcher"),t.appendChild(s)}else t.classList.add("treejs-placeholder");var n=document.createElement("span");n.classList.add("treejs-checkbox"),t.appendChild(n);var i=document.createTextNode(e.text);return t.appendChild(i),t.nodeId=e.id,t}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={method:"GET",url:"",async:!0,success:null,failed:null,"Content-Type":"application/json; charset=utf-8"},s=Object.assign(t,e),n=new XMLHttpRequest,i=[];for(var o in s.data)s.data.hasOwnProperty(o)&&i.push(o+"="+s.data[o]);var a=i.join("&");if("POST"===s.method.toUpperCase())n.open(s.method,s.url,s.async),n.setRequestHeader("Content-Type",s["Content-Type"]),n.send(a);else if("GET"===s.method.toUpperCase()){var d=s.url;a&&(-1!==d.indexOf("?")?d+="&"+a:d+="?"+a),n.open(s.method,d,s.async),n.setRequestHeader("Content-Type",s["Content-Type"]),n.send(null)}n.onreadystatechange=function(){if(4===n.readyState&&200===n.status){var e=n.responseText;s["Content-Type"]===t["Content-Type"]&&(e=JSON.parse(e)),s.success&&s.success(e)}else s.failed&&s.failed(n.status)}}},function(e,t,s){}]).default});
//# sourceMappingURL=tree.min.js.map